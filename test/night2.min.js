!(function (t, e) {
  'object' == typeof exports && 'object' == typeof module
    ? (module.exports = e())
    : 'function' == typeof define && define.amd
    ? define('night2', [], e)
    : 'object' == typeof exports
    ? (exports.night2 = e())
    : (t.night2 = e());
})('undefined' != typeof self ? self : this, function () {
  return (function (t) {
    var e = {};
    function o(n) {
      if (e[n]) return e[n].exports;
      var a = (e[n] = { i: n, l: !1, exports: {} });
      return t[n].call(a.exports, a, a.exports, o), (a.l = !0), a.exports;
    }
    return (
      (o.m = t),
      (o.c = e),
      (o.d = function (t, e, n) {
        o.o(t, e) || Object.defineProperty(t, e, { enumerable: !0, get: n });
      }),
      (o.r = function (t) {
        'undefined' != typeof Symbol &&
          Symbol.toStringTag &&
          Object.defineProperty(t, Symbol.toStringTag, { value: 'Module' }),
          Object.defineProperty(t, '__esModule', { value: !0 });
      }),
      (o.t = function (t, e) {
        if ((1 & e && (t = o(t)), 8 & e)) return t;
        if (4 & e && 'object' == typeof t && t && t.__esModule) return t;
        var n = Object.create(null);
        if (
          (o.r(n),
          Object.defineProperty(n, 'default', { enumerable: !0, value: t }),
          2 & e && 'string' != typeof t)
        )
          for (var a in t)
            o.d(
              n,
              a,
              function (e) {
                return t[e];
              }.bind(null, a)
            );
        return n;
      }),
      (o.n = function (t) {
        var e =
          t && t.__esModule
            ? function () {
                return t.default;
              }
            : function () {
                return t;
              };
        return o.d(e, 'a', e), e;
      }),
      (o.o = function (t, e) {
        return Object.prototype.hasOwnProperty.call(t, e);
      }),
      (o.p = ''),
      o((o.s = 0))
    );
  })([
    function (t, e, o) {
      'use strict';
      function n(t) {
        return (n =
          'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator
            ? function (t) {
                return typeof t;
              }
            : function (t) {
                return t && 'function' == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype
                  ? 'symbol'
                  : typeof t;
              })(t);
      }
      Object.defineProperty(e, '__esModule', { value: !0 }), (e.default = void 0);
      var a = (function (t, e) {
        if (!e && t && t.__esModule) return t;
        if (null === t || ('object' !== n(t) && 'function' != typeof t)) return { default: t };
        var o = i(e);
        if (o && o.has(t)) return o.get(t);
        var a = {},
          r = Object.defineProperty && Object.getOwnPropertyDescriptor;
        for (var l in t)
          if ('default' !== l && Object.prototype.hasOwnProperty.call(t, l)) {
            var s = r ? Object.getOwnPropertyDescriptor(t, l) : null;
            s && (s.get || s.set) ? Object.defineProperty(a, l, s) : (a[l] = t[l]);
          }
        (a.default = t), o && o.set(t, a);
        return a;
      })(o(1));
      function i(t) {
        if ('function' != typeof WeakMap) return null;
        var e = new WeakMap(),
          o = new WeakMap();
        return (i = function (t) {
          return t ? o : e;
        })(t);
      }
      var r = a.default;
      (e.default = r),
        a.IS_BROWSER &&
          (function (t) {
            t.Night2 = a.default;
          })(window),
        (t.exports = e.default);
    },
    function (t, e, o) {
      'use strict';
      Object.defineProperty(e, '__esModule', { value: !0 }), (e.default = e.IS_BROWSER = void 0);
      var n,
        a = (n = o(2)) && n.__esModule ? n : { default: n };
      function i(t, e) {
        if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function');
      }
      function r(t, e) {
        for (var o = 0; o < e.length; o++) {
          var n = e[o];
          (n.enumerable = n.enumerable || !1),
            (n.configurable = !0),
            'value' in n && (n.writable = !0),
            Object.defineProperty(t, n.key, n);
        }
      }
      var l = 'undefined' != typeof window;
      e.IS_BROWSER = l;
      var s = (function () {
        function t() {
          var e = this,
            o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
          i(this, t),
            (this.settings = this.extendSettings(o)),
            console.log('constructor auto = ', localStorage.auto),
            console.log('constructor dark = ', localStorage.dark),
            console.log('constructor light = ', localStorage.light),
            (this.today = new Date()),
            this.time(this.today),
            setInterval(function () {
              return e.time(new Date());
            }, this.settings.intervalForTime),
            this.settings.auto && this.auto(!0),
            this.theme();
        }
        var e, o, n;
        return (
          (e = t),
          (o = [
            {
              key: 'time',
              value: function (t) {
                console.log('time now = ', t);
                var e = new Date().setHours(24, 0, 0, 0);
                localStorage.time
                  ? localStorage.location &&
                    t.getTime() > JSON.parse(localStorage.time) &&
                    (localStorage.removeItem('time'),
                    this.settings.cacheClear &&
                      (localStorage.removeItem('location'),
                      'function' == typeof this.settings.onCacheClear && this.settings.onCacheClear()))
                  : (localStorage.setItem('time', JSON.stringify(e)),
                    localStorage.location || ('geolocation' in navigator && this.myLocation()));
              }
            },
            {
              key: 'theme',
              value: function () {
                return (
                  console.log('theme dark?', localStorage.dark),
                  'true' === localStorage.dark ? this.dark() : this.light()
                );
              }
            },
            {
              key: 'auto',
              value: function (t) {
                console.log('auto(init)', t),
                  ((t && !localStorage.auto) || !t) &&
                    (console.log('set auto true', t),
                    localStorage.setItem('auto', 'true'),
                    'function' == typeof this.settings.onAuto && this.settings.onAuto()),
                  'geolocation' in navigator && this.myLocation();
              }
            },
            {
              key: 'myLocation',
              value: function () {
                if (localStorage.location) {
                  var t = JSON.parse(localStorage.location);
                  console.log('myLocation location', t), this.checkSunPosition(t.latitude, t.longitude);
                } else
                  console.log('myLocation localStorage.location', localStorage.location),
                    navigator.geolocation.getCurrentPosition(this.success.bind(this), this.error.bind(this));
              }
            },
            {
              key: 'success',
              value: function (t) {
                console.log('success');
                var e = { latitude: t.coords.latitude, longitude: t.coords.longitude };
                console.log('location', e),
                  this.checkSunPosition(e.latitude, e.longitude),
                  this.settings.cache && localStorage.setItem('location', JSON.stringify(e));
              }
            },
            {
              key: 'error',
              value: function (t) {
                console.log('error'),
                  'function' == typeof this.settings.onDenied && this.settings.onDenied(),
                  document.dispatchEvent(new CustomEvent('smartDarkError', { detail: t }));
              }
            },
            {
              key: 'checkSunPosition',
              value: function (t, e) {
                var o = this,
                  n = new a.default.getTimes(this.today, t, e),
                  i = n.sunriseEnd - (n.sunriseEnd - n.sunrise) / 2 + 60 * this.settings.offset * 1e3,
                  r = n.sunset - (n.sunset - n.sunsetStart) / 2 - 60 * this.settings.offset * 1e3,
                  l = { sunrise: new Date(i), sunset: new Date(r), latitude: t, longitude: e };
                if (
                  (console.log('checkSunPosition values', l),
                  document.dispatchEvent(new CustomEvent('smartDark', { detail: l })),
                  localStorage.auto && JSON.parse(localStorage.auto))
                ) {
                  console.log('시작시 한번 실행하고,  다음에 인터벌');
                  var s = new Date();
                  s.getTime() > i && s.getTime() < r ? this.light() : this.dark();
                }
                this.intervalForCheckSunPosition = setInterval(function () {
                  if (
                    (console.log('interval localStorage.auto', localStorage.auto),
                    localStorage.auto && JSON.parse(localStorage.auto))
                  ) {
                    console.log('선 포지션 체크함');
                    var t = new Date();
                    t.getTime() > i && t.getTime() < r ? o.light() : o.dark();
                  }
                }, this.settings.intervalForCheckSun);
              }
            },
            {
              key: 'reset',
              value: function () {
                console.log('reset'),
                  localStorage.clear(),
                  clearInterval(this.intervalForCheckSunPosition),
                  'function' == typeof this.settings.onReset && this.settings.onReset();
              }
            },
            {
              key: 'light',
              value: function () {
                console.log('light mode'),
                  console.log('    localStorage.auto', localStorage.auto),
                  console.log('    localStorage.dark', localStorage.dark),
                  console.log('    localStorage.time', localStorage.time),
                  console.log('    localStorage.location', localStorage.location),
                  'function' == typeof this.settings.onLight && this.settings.onLight(),
                  (this.isDark = !1),
                  this.settings.lightClass &&
                    document.getElementById(this.settings.divId).classList.add(this.settings.lightClass),
                  document.getElementById(this.settings.divId).classList.remove(this.settings.darkClass),
                  localStorage.setItem('dark', 'false');
              }
            },
            {
              key: 'dark',
              value: function () {
                console.log('dark mode'),
                  console.log('    localStorage.auto', localStorage.auto),
                  console.log('    localStorage.dark', localStorage.dark),
                  console.log('    localStorage.time', localStorage.time),
                  console.log('    localStorage.location', localStorage.location),
                  'function' == typeof this.settings.onDark && this.settings.onDark(),
                  (this.isDark = !0),
                  this.settings.lightClass &&
                    document.getElementById(this.settings.divId).classList.remove(this.settings.lightClass),
                  document.getElementById(this.settings.divId).classList.add(this.settings.darkClass),
                  localStorage.setItem('dark', 'true');
              }
            },
            {
              key: 'toggle',
              value: function () {
                console.log('toggle'),
                  'function' == typeof this.settings.onToggle && this.settings.onToggle(),
                  this.isDark ? this.light() : this.dark(),
                  localStorage.setItem('auto', 'false');
              }
            },
            {
              key: 'extendSettings',
              value: function (t) {
                var e = {
                    divId: 'default',
                    lightClass: '',
                    darkClass: 'dark',
                    cache: !0,
                    cacheClear: !0,
                    auto: !0,
                    intervalForCheckSun: 6e5,
                    intervalForTime: 36e5,
                    offset: 30,
                    onAuto: null,
                    onLight: null,
                    onDark: null,
                    onToggle: null,
                    onDenied: null,
                    onCacheClear: null,
                    onReset: null
                  },
                  o = {};
                for (var n in e) o[n] = n in t ? t[n] : e[n];
                return o;
              }
            }
          ]) && r(e.prototype, o),
          n && r(e, n),
          t
        );
      })();
      e.default = s;
    },
    function (t, e, o) {
      !(function () {
        'use strict';
        var e = Math.PI,
          o = Math.sin,
          n = Math.cos,
          a = Math.tan,
          i = Math.asin,
          r = Math.atan2,
          l = Math.acos,
          s = e / 180;
        function u(t) {
          return new Date(864e5 * (t + 0.5 - 2440588));
        }
        function c(t) {
          return (
            (function (t) {
              return t.valueOf() / 864e5 - 0.5 + 2440588;
            })(t) - 2451545
          );
        }
        var g = 23.4397 * s;
        function f(t, e) {
          return r(o(t) * n(g) - a(e) * o(g), n(t));
        }
        function d(t, e) {
          return i(o(e) * n(g) + n(e) * o(g) * o(t));
        }
        function h(t, e, i) {
          return r(o(t), n(t) * o(e) - a(i) * n(e));
        }
        function v(t, e, a) {
          return i(o(e) * o(a) + n(e) * n(a) * n(t));
        }
        function m(t, e) {
          return s * (280.16 + 360.9856235 * t) - e;
        }
        function y(t) {
          return s * (357.5291 + 0.98560028 * t);
        }
        function S(t) {
          return t + s * (1.9148 * o(t) + 0.02 * o(2 * t) + 3e-4 * o(3 * t)) + 102.9372 * s + e;
        }
        function p(t) {
          var e = S(y(t));
          return { dec: d(e, 0), ra: f(e, 0) };
        }
        var k = {
            getPosition: function (t, e, o) {
              var n = s * -o,
                a = s * e,
                i = c(t),
                r = p(i),
                l = m(i, n) - r.ra;
              return { azimuth: h(l, a, r.dec), altitude: v(l, a, r.dec) };
            }
          },
          b = (k.times = [
            [-0.833, 'sunrise', 'sunset'],
            [-0.3, 'sunriseEnd', 'sunsetStart'],
            [-6, 'dawn', 'dusk'],
            [-12, 'nauticalDawn', 'nauticalDusk'],
            [-18, 'nightEnd', 'night'],
            [6, 'goldenHourEnd', 'goldenHour']
          ]);
        k.addTime = function (t, e, o) {
          b.push([t, e, o]);
        };
        function w(t, o, n) {
          return 9e-4 + (t + o) / (2 * e) + n;
        }
        function M(t, e, n) {
          return 2451545 + t + 0.0053 * o(e) - 0.0069 * o(2 * n);
        }
        function O(t, e, a, i, r, s, u) {
          return M(
            w(
              (function (t, e, a) {
                return l((o(t) - o(e) * o(a)) / (n(e) * n(a)));
              })(t, a, i),
              e,
              r
            ),
            s,
            u
          );
        }
        function D(t) {
          var e = s * (134.963 + 13.064993 * t),
            a = s * (93.272 + 13.22935 * t),
            i = s * (218.316 + 13.176396 * t) + 6.289 * s * o(e),
            r = 5.128 * s * o(a),
            l = 385001 - 20905 * n(e);
          return { ra: f(i, r), dec: d(i, r), dist: l };
        }
        function P(t, e) {
          return new Date(t.valueOf() + (864e5 * e) / 24);
        }
        (k.getTimes = function (t, o, n) {
          var a,
            i,
            r,
            l,
            g,
            f = s * -n,
            h = s * o,
            v = (function (t, o) {
              return Math.round(t - 9e-4 - o / (2 * e));
            })(c(t), f),
            m = w(0, f, v),
            p = y(m),
            k = S(p),
            D = d(k, 0),
            P = M(m, p, k),
            I = { solarNoon: u(P), nadir: u(P - 0.5) };
          for (a = 0, i = b.length; a < i; a += 1)
            (g = P - ((l = O((r = b[a])[0] * s, f, h, D, v, p, k)) - P)), (I[r[1]] = u(g)), (I[r[2]] = u(l));
          return I;
        }),
          (k.getMoonPosition = function (t, e, i) {
            var l = s * -i,
              u = s * e,
              g = c(t),
              f = D(g),
              d = m(g, l) - f.ra,
              y = v(d, u, f.dec),
              S = r(o(d), a(u) * n(f.dec) - o(f.dec) * n(d));
            return (
              (y += (function (t) {
                return t < 0 && (t = 0), 2967e-7 / Math.tan(t + 0.00312536 / (t + 0.08901179));
              })(y)),
              { azimuth: h(d, u, f.dec), altitude: y, distance: f.dist, parallacticAngle: S }
            );
          }),
          (k.getMoonIllumination = function (t) {
            var e = c(t || new Date()),
              a = p(e),
              i = D(e),
              s = l(o(a.dec) * o(i.dec) + n(a.dec) * n(i.dec) * n(a.ra - i.ra)),
              u = r(149598e3 * o(s), i.dist - 149598e3 * n(s)),
              g = r(n(a.dec) * o(a.ra - i.ra), o(a.dec) * n(i.dec) - n(a.dec) * o(i.dec) * n(a.ra - i.ra));
            return {
              fraction: (1 + n(u)) / 2,
              phase: 0.5 + (0.5 * u * (g < 0 ? -1 : 1)) / Math.PI,
              angle: g
            };
          }),
          (k.getMoonTimes = function (t, e, o, n) {
            var a = new Date(t);
            n ? a.setUTCHours(0, 0, 0, 0) : a.setHours(0, 0, 0, 0);
            for (
              var i,
                r,
                l,
                u,
                c,
                g,
                f,
                d,
                h,
                v,
                m,
                y,
                S,
                p = 0.133 * s,
                b = k.getMoonPosition(a, e, o).altitude - p,
                w = 1;
              w <= 24 &&
              ((i = k.getMoonPosition(P(a, w), e, o).altitude - p),
              (d =
                ((c = (b + (r = k.getMoonPosition(P(a, w + 1), e, o).altitude - p)) / 2 - i) *
                  (f = -(g = (r - b) / 2) / (2 * c)) +
                  g) *
                  f +
                i),
              (v = 0),
              (h = g * g - 4 * c * i) >= 0 &&
                ((m = f - (S = Math.sqrt(h) / (2 * Math.abs(c)))),
                (y = f + S),
                Math.abs(m) <= 1 && v++,
                Math.abs(y) <= 1 && v++,
                m < -1 && (m = y)),
              1 === v
                ? b < 0
                  ? (l = w + m)
                  : (u = w + m)
                : 2 === v && ((l = w + (d < 0 ? y : m)), (u = w + (d < 0 ? m : y))),
              !l || !u);
              w += 2
            )
              b = r;
            var M = {};
            return (
              l && (M.rise = P(a, l)),
              u && (M.set = P(a, u)),
              l || u || (M[d > 0 ? 'alwaysUp' : 'alwaysDown'] = !0),
              M
            );
          }),
          (t.exports = k);
      })();
    }
  ]);
});
